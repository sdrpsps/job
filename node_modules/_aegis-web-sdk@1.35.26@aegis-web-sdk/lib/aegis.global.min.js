/**
 *  ==================================================================
 * aegis-web-sdk@1.35.26 (c) 2022 TencentCloud Real User Monitoring.
 * Author pumpkincai.
 * Last Release Time Fri May 27 2022 15:24:38 GMT+0800 (GMT+08:00).
 * Released under the MIT License.
 * Thanks for supporting RUM & Aegis!
 * ==================================================================
 **/
var Aegis=function(){"use strict";var t,n;function e(e){this.name="__st"+(1e9*Math.random()>>>0)+t+"__",null==e||e.forEach(this.add,this),t+=1}Array.prototype.find||Object.defineProperty(Array.prototype,"find",{configurable:!0,writable:!0,value:function(e){if(null===this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var o=arguments[1],i=0;i<n;){var r=t[i];if(e.call(o,r,i,t))return r;i+=1}}}),String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(e,t){return this.substring(t=!t||t<0?0:+t,t+e.length)===e}}),window.WeakSet||(t=Date.now()%1e9,e.prototype.add=function(e){var t=this.name;return e[t]||Object.defineProperty(e,t,{value:!0,writable:!0}),this},e.prototype.delete=function(e){return!!e[this.name]&&!(e[this.name]=void 0)},e.prototype.has=function(e){return!!e[this.name]},n=e,Object.defineProperty(window,"WeakSet",{value:function(e){return new n(e)}})),Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(null==e)throw new TypeError("Cannot convert first argument to object");for(var t=Object(e),n=1;n<arguments.length;n++)if(null!=(o=arguments[n]))for(var o=Object(o),i=Object.keys(Object(o)),r=0,s=i.length;r<s;r++){var a=i[r],c=Object.getOwnPropertyDescriptor(o,a);null!=c&&c.enumerable&&(t[a]=o[a])}return t}});var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},E=function(){return(E=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function l(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var o=Array(e),i=0,t=0;t<n;t++)for(var r=arguments[t],s=0,a=r.length;s<a;s++,i++)o[i]=r[s];return o}function R(t){try{return encodeURIComponent(decodeURIComponent(t))}catch(e){return t}}var h,r=(i.prototype.indexOf=function(e,t){for(var n=0;n<e.length;n++)if(e[n].callback===t)return n;return-1},i.prototype.on=function(e,t,n){if(void 0===n&&(n=0),this){var o=this.eventsList[e];return(o||(this.eventsList[e]=[],o=this.eventsList[e]),-1!==this.indexOf(o,t))?this:(o.push({name:e,type:n||0,callback:t}),this)}},i.prototype.one=function(e,t){this.on(e,t,1)},i.prototype.remove=function(e,t){if(this){var n=this.eventsList[e];if(!n)return null;if(t)return n.length&&(t=this.indexOf(n,t),n.splice(t,1)),this;try{delete this.eventsList[e]}catch(e){}return null}},i.prototype.clear=function(){this.eventsList={}},i);function i(){var s=this;this.emit=function(e,t){if(s){var n;if(null!=(o=s.eventsList[e])&&o.length)for(var o=o.slice(),i=0;i<o.length;i++){n=o[i];try{var r=n.callback.apply(s,[t]);if(1===n.type&&s.remove(e,n.callback),!1===r)break}catch(e){throw e}}return s}},this.eventsList={}}(st=h=h||{})[st.number=-1]="number",st.string="";function s(e,t){return"number"==typeof e||"string"==typeof e?e:t?h.string:h.number}function g(e,t){return"string"==typeof e?e.split("?")[t?1:0]||"":e}function v(e){return"string"==typeof e&&e.startsWith("//")?"undefined"!=typeof location&&"https:"===location.protocol:/^https/.test(e)}function d(t){return c.some(function(e){return-1!==t.indexOf(e)})}function a(){var n=new WeakSet;return function(e,t){if(t instanceof Error)return"Error.message: "+t.message+" \n  Error.stack: "+t.stack;if("object"==typeof t&&null!==t){if(n.has(t))return"[Circular "+(e||"root")+"]";n.add(t)}return t}}var O,S,f,c=["application/octet-stream","application/xhtml+xml","application/xml","application/pdf","application/pkcs12","application/javascript","application/ecmascript","application/vnd.mspowerpoint","application/vnd.apple.mpegurl","application/ogg","text/css","text/javascript","image","audio","video"],u=["ret","retcode","code","errcode"],m=function(e,t,n){var o;try{if("function"==typeof(null==t?void 0:t.retCodeHandler)){var i=t.retCodeHandler(e,null==n?void 0:n.url,null==n?void 0:n.ctx)||{};return{code:void 0===(r=i.code)?"unknown":r,isErr:i.isErr}}"string"==typeof e&&(e=JSON.parse(e)),"function"==typeof(null===(o=null==t?void 0:t.ret)||void 0===o?void 0:o.join)&&(u=[].concat(t.ret.map(function(e){return e.toLowerCase()})));var r,s=Object.getOwnPropertyNames(e).filter(function(e){return-1!==u.indexOf(e.toLowerCase())});return s.length?{code:""+(r=Number(e[s[0]])),isErr:0!==r}:{code:"unknown",isErr:!1}}catch(e){return{code:"unknown",isErr:!1}}},T=function(e){if("string"==typeof e)return e;try{return e instanceof Error?(JSON.stringify(e,a(),4)||"undefined").replace(/"/gim,""):JSON.stringify(e,a(),4)||"undefined"}catch(e){return"error happen when aegis stringify: \n "+e.message+" \n "+e.stack}},p=function(e){if("string"==typeof e)return e;try{return JSON.stringify(e,a())||"undefined"}catch(e){return"error happen when aegis stringify: \n "+e.message+" \n "+e.stack}},y=function(n,o){void 0===o&&(o=3);var i,r,s,a="";return Array.isArray(n)?(a+="[",i=n.length,n.forEach(function(e,t){a+="object"==typeof e&&1<o?y(e,o-1):b(e),a+=t===i-1?"":","}),a+="]"):n instanceof Object?(a="{",r=Object.keys(n),s=r.length,r.forEach(function(e,t){"object"==typeof n[e]&&1<o?a+='"'+e+'":'+y(n[e],o-1):a+=w(e,n[e]),a+=t===s-1||t<s-1&&void 0===n[r[t+1]]?"":","}),a+="}"):a+=n,a},w=function(e,t){var n=typeof t,o="";return"string"==n||"object"==n?o+='"'+e+'":"'+t+'"':"function"==typeof t?o+='"'+e+'":"function '+t.name+'"':"symbol"==typeof t?o+='"'+e+'":"symbol"':"number"!=typeof t&&"boolean"!=n||(o+='"'+e+'": '+t),o},b=function(e){var t=typeof e;return""+("undefined"==t||"symbol"==t||"function"==t?"null":"string"==t||"object"==t?'"'+e+'"':e)},L=(C.prototype.sourceURL=function(){return this.data.responseURL},C.prototype.status=function(){return Number(this.data.status)},C.prototype.headers=function(){var e=this.data.getAllResponseHeaders().split("\n"),n={};return e.forEach(function(e){var t;e&&(e=(t=e.split(": "))[0],t=t[1].trim(),n[e]=t)}),n},C),P=(x.prototype.sourceURL=function(){return this.data.url},x.prototype.status=function(){return Number(this.data.status)},x.prototype.headers=function(){var n={};return this.data.headers.forEach(function(e,t){n[t]=e}),n},x);function x(e,t){this.type="fetch",this.data=e||{},this.data.response=t}function C(e){this.type="xhr",this.data=e}(et=O=O||{}).INFO_ALL="-1",et.API_RESPONSE="1",et.INFO="2",et.ERROR="4",et.PROMISE_ERROR="8",et.AJAX_ERROR="16",et.SCRIPT_ERROR="32",et.IMAGE_ERROR="64",et.CSS_ERROR="128",et.CONSOLE_ERROR="256",et.MEDIA_ERROR="512",et.RET_ERROR="1024",et.REPORT="2048",et.PV="4096",et.EVENT="8192",et.PAGE_NOT_FOUND_ERROR="16384",et.WEBSOCKET_ERROR="32768",(Oe={})[Oe.android=1]="android",Oe[Oe.ios=2]="ios",Oe[Oe.windows=3]="windows",Oe[Oe.macos=4]="macos",Oe[Oe.linux=5]="linux",Oe[Oe.devtools=6]="devtools",Oe[Oe.other=100]="other",(Ce={})[Ce.unknown=100]="unknown",Ce[Ce.wifi=1]="wifi",Ce[Ce.net2g=2]="net2g",Ce[Ce.net3g=3]="net3g",Ce[Ce.net4g=4]="net4g",Ce[Ce.net5g=5]="net5g",Ce[Ce.net6g=6]="net6g",(Ae=S=S||{}).LOG="log",Ae.SPEED="speed",Ae.PERFORMANCE="performance",Ae.OFFLINE="offline",Ae.WHITE_LIST="whiteList",Ae.VITALS="vitals",Ae.PV="pv",Ae.CUSTOM_PV="customPV",Ae.EVENT="event",Ae.CUSTOM="custom",Ae.SDK_ERROR="sdkError",Ae.SET_DATA="setData",(Ke=f=f||{}).production="production",Ke.gray="gray",Ke.pre="pre",Ke.daily="daily",Ke.local="local",Ke.test="test",Ke.others="others";function I(e){return e.filter(function(n,o){return"static"!==n.type||!e.find(function(e,t){return n.url===e.url&&200===n.status&&o<t})})}function k(e){e.level===O.INFO_ALL&&(e.level=O.INFO)}function A(i){return function(e,t){i.lifeCycle.emit("modifyRequest",e);var n=i.config.modifyRequest;if("function"==typeof n)try{var o=n(e);"object"==typeof o&&"url"in o&&(e=o)}catch(e){console.error(e)}t(e)}}function N(o){return function(e,t){o.lifeCycle.emit("afterRequest",e);var n=o.config.afterRequest;"function"==typeof n&&!1===n(e)||t(e)}}function U(){}function _(t,n){Object.getOwnPropertyNames(t).forEach(function(e){"function"==typeof t[e]&&"constructor"!==e&&(n?n[e]="sendPipeline"===e?function(){return function(){}}:function(){}:t[e]=function(){})})}function j(t){if(t.payload){var n={};return Object.keys(t).forEach(function(e){"payload"!==e&&(n[e]=t[e])}),n}return t}function q(){return void 0!==window.performance&&"function"==typeof performance.clearResourceTimings&&"function"==typeof performance.getEntriesByType&&"function"==typeof performance.now}function F(t,n){var o=function(e){"pagehide"!==e.type&&"hidden"!==document.visibilityState||(t(e),n&&(removeEventListener("visibilitychange",o,!0),removeEventListener("pagehide",o,!0)))};addEventListener("visibilitychange",o,!0),addEventListener("pagehide",o,!0)}function D(t){var n,o;ae.find(function(e){return e.name===t.name})||(ae.push(t),se||!window.XMLHttpRequest)||(se=!0,n=window.XMLHttpRequest.prototype.send,o=window.XMLHttpRequest.prototype.open,window.XMLHttpRequest.prototype.open=function(){if(this.aegisMethod=arguments[0],this.aegisUrl=arguments[1],this.aegisXhrStartTime=Date.now(),!this.sendByAegis)for(var e=0;e<ae.length;e++){var t=ae[e];try{"function"==typeof t.open&&t.open(this)}catch(e){}}return o.apply(this,arguments)},window.XMLHttpRequest.prototype.send=function(){if(!this.sendByAegis)for(var e=0;e<ae.length;e++){var t=ae[e];try{"function"==typeof t.send&&t.send(this,arguments[0])}catch(e){}}return n.apply(this,arguments)})}function M(t){var e=ae.findIndex(function(e){return e.name===t.name});-1!==e&&ae.splice(e,1)}var H,B,W=function(o,i){return function(e,t){var n=i.logCreated;if("function"!=typeof n)return o("beforeWrite",e),t(e);e=e.filter(function(e){return!1!==n(e)});return o("beforeWrite",e),t(e)}},V=function(n,o){var i,r=[],s=n.config;return n.lifeCycle.on("destroy",function(){r.length=0}),function(e,t){if(Array.isArray(e)?r=r.concat(e):r.push(e),o&&r.length>=o||n.sendNow&&0<r.length)return r=I(r),t(r.splice(0,r.length)),void(i&&clearTimeout(i));i&&clearTimeout(i),i=setTimeout(function(){i=null,0<(r=I(r)).length&&t(r.splice(0,r.length))},s.delay)}},X=function(e,t){return Array.isArray(e)?t(e.map(function(e){return E(E({},e),{msg:"string"==typeof e.msg?e.msg:[].concat(e.msg).map(T).join(" ")})})):t([E(E({},e),{msg:"string"==typeof e.msg?e.msg:T(e.msg)})])},G=function(s){var e,a=!1,c=!1,t=!1,u=[];return s.lifeCycle.on("onConfigChange",function(){e&&clearTimeout(e),e=setTimeout(function(){var e,n;!t&&s.config&&(t=!0,e=s.config.whiteListUrl,(n=void 0===e?"":e)&&s.sendPipeline([function(e,t){t({url:n,type:S.WHITE_LIST,success:function(e){c=!0;try{var t=e.data||JSON.parse(e),n=t.retcode,o=t.result,i=void 0===o?{}:o;if(0===n){if(a=i.is_in_white_list,s.isWhiteList=a,i.shutdown)return void s.destroy();0<=i.rate&&i.rate<=1&&(s.config.random=i.rate,s.isGetSample=!1)}s.isWhiteList&&u.length?K(s)(u.splice(0),function(){}):!s.isWhiteList&&u.length&&(u.length=0);var r=s.config.onWhitelist;"function"==typeof r&&r(a)}catch(e){}},fail:function(e){"403 forbidden"===e&&s.destroy(),c=!0}})}],S.WHITE_LIST)(null),t=!1)},s.config.uin?50:500)}),s.lifeCycle.on("destroy",function(){u.length=0}),function(e,t){var n;a||null!==(n=null===(n=s.config)||void 0===n?void 0:n.api)&&void 0!==n&&n.reportRequest?t(e.concat(u.splice(0)).map(function(e){return k(e),e})):(e=e.filter(function(e){return e.level!==O.INFO&&e.level!==O.API_RESPONSE?(k(e),!0):(c||(u.push(e),200<=u.length&&(u.length=200)),!1)})).length&&t(e)}},J=function(o){return setTimeout(function(){var e=o.config.pvUrl,n=void 0===e?"":e;n&&o.sendPipeline([function(e,t){t({url:n,type:S.PV,fail:function(e){"403 forbidden"===e&&o.destroy()}})}],S.PV)(null)},100),function(e,t){t(e)}},$=function(i){var r={};return function(e,t){var n,o;i.speedSample?(o="object"==typeof i.repeat?i.repeat:{repeat:i.repeat},n=+o.speed||+o.repeat||5,Array.isArray(e)?(o=e.filter(function(e){var t=!r[e.url]||r[e.url]<n;return r[e.url]=1+~~r[e.url],t})).length&&t(o):(!r[e.url]||r[e.url]<n)&&(r[e.url]=1+~~r[e.url],t(e))):t(e)}},Q=function(o){var i={};return function(e,t){var n="number"==typeof o.repeat?o.repeat:5;if(0===n)return t(e);t(e.filter(function(e){return e.level!==O.ERROR&&e.level!==O.PROMISE_ERROR&&e.level!==O.AJAX_ERROR&&e.level!==O.SCRIPT_ERROR&&e.level!==O.IMAGE_ERROR&&e.level!==O.CSS_ERROR&&e.level!==O.MEDIA_ERROR||(i[e.msg]=i[e.msg]||0,i[e.msg]+=1,!(i[e.msg]>n))}))}},K=function(o){return function(e){return o.sendPipeline([function(e,n){return n({url:o.config.url||"",data:function(e){if(!e||0===e.length)return"{}";e=Array.isArray(e)?e:[e];var t=Object.keys(e[0]),n={};return t.forEach(function(t){n[t]=e.map(function(e){return e[t]})}),n.count=e.length,p(n)}((t=e,(Array.isArray(t)?t:[t]).map(function(n){return Object.getOwnPropertyNames(n).reduce(function(e,t){return"ctx"!==t&&(e[t]=n[t]),e},{level:O.INFO,msg:""})}))),method:"post",contentType:"application/json",type:S.LOG,log:e,requestConfig:{timeout:5e3},success:function(){var t=o.config.onReport;"function"==typeof t&&e.forEach(function(e){t(e)}),"function"==typeof n&&n([])},fail:function(e){"403 forbidden"===e&&o.destroy()}});var t}],S.LOG)(e)}},Y=function(o){return function(e){o.sendPipeline([function(e,t){var n=e.map(function(e){return{name:e.name,ext1:e.ext1||o.config.ext1||"",ext2:e.ext2||o.config.ext2||"",ext3:e.ext3||o.config.ext3||""}});t({url:o.config.eventUrl+"?payload="+encodeURIComponent(JSON.stringify(n)),type:S.EVENT,log:e,fail:function(e){"403 forbidden"===e&&o.destroy()}})}],S.EVENT)(e)}},z=function(n){return function(e){return n.sendPipeline([function(e,t){t({url:n.config.customTimeUrl+"?payload="+encodeURIComponent(JSON.stringify({custom:e})),type:S.CUSTOM,log:e,fail:function(e){"403 forbidden"===e&&n.destroy()}})}],S.CUSTOM)(e)}},Z=function(n){if(!n||!n.reduce||!n.length)throw new TypeError("createPipeline need at least one function param");return 1===n.length?function(e,t){n[0](e,t||U)}:n.reduce(function(n,o){return function(e,t){return void 0===t&&(t=U),n(e,function(e){return null==o?void 0:o(e,t)})}})},ee=(Object.defineProperty(de.prototype,"__version__",{get:function(){return console.warn("__version__ has discard, please use version"),"1.35.26"},enumerable:!1,configurable:!0}),Object.defineProperty(de.prototype,"LogType",{get:function(){return console.warn("LogType has discard, please use logType"),O},enumerable:!1,configurable:!0}),de.prototype.init=function(e){this.setConfig(e);for(var t=0;t<de.installedPlugins.length;t++)try{de.installedPlugins[t].patch(this)}catch(e){this.sendSDKError(e)}this.lifeCycle.emit("onInited")},de.prototype.setConfig=function(e){Object.assign(this.config,e);var t=this.config,n=t.id,o=t.uin,i=t.version,r=t.ext1,s=t.ext2,a=t.ext3,c=t.aid,e=t.env,u=void 0===e?"production":e,e=t.pageUrl,t=this.bean.id!==n||this.bean.uin!==o||this.bean.aid!==c;return this.bean.id=n||"",this.bean.uin=o||"",this.bean.version=i||"1.35.26",this.bean.aid=c||"",this.bean.env=function(){switch(u){case f.production:case f.gray:case f.pre:case f.daily:case f.local:case f.test:case f.others:return 1;default:return}}()?u:f.others,e&&this.extendBean("from",encodeURIComponent(e)),r&&this.extendBean("ext1",encodeURIComponent(r)),s&&this.extendBean("ext2",encodeURIComponent(s)),a&&this.extendBean("ext3",encodeURIComponent(a)),t&&this.lifeCycle.emit("onConfigChange",this.config),this.config},de.use=function(e){-1===de.installedPlugins.indexOf(e)&&e.aegisPlugin&&de.installedPlugins.push(e)},de.unuse=function(e){e=de.installedPlugins.indexOf(e);-1!==e&&de.installedPlugins.splice(e,1)},de.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n={level:O.INFO,msg:e};1===e.length&&e[0].msg&&Object.assign(n,E({},e[0]),{level:O.INFO}),this.normalLogPipeline(n)},de.prototype.infoAll=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n={level:O.INFO_ALL,msg:e};1===e.length&&e[0].msg&&Object.assign(n,E({},e[0]),{level:O.INFO_ALL}),this.normalLogPipeline(n)},de.prototype.report=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n={level:O.REPORT,msg:e};1===e.length&&e[0].msg&&Object.assign(n,E({},e[0])),this.normalLogPipeline(n)},de.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n={level:O.ERROR,msg:e};1===e.length&&e[0].msg&&Object.assign(n,E({},e[0]),{level:O.ERROR}),this.normalLogPipeline(n)},de.prototype.speedLogPipeline=function(e){throw new Error('You need to override "speedLogPipeline" method')},de.prototype.reportPv=function(n){var o,i=this;n&&(console.warn("reportPv is deprecated, please use reportEvent"),o=""+Object.getOwnPropertyNames(this.bean).filter(function(e){return"id"!==e}).map(function(e){return e+"="+i.bean[e]}).join("&"),this.sendPipeline([function(e,t){t({url:i.config.url+"/"+n+"?"+o,addBean:!1,type:S.CUSTOM_PV,fail:function(e){"403 forbidden"===e&&i.destroy()}})}],S.CUSTOM_PV)(null))},de.prototype.reportEvent=function(e){e&&((e="string"==typeof e?{name:e,ext1:this.config.ext1||"",ext2:this.config.ext2||"",ext3:this.config.ext3||""}:e).name?this.eventPipeline(e):console.warn("reportEvent params error"))},de.prototype.reportTime=function(e,t){if("object"==typeof e)return this.reportT(e);"string"==typeof e?"number"==typeof t?t<0||6e4<t?console.warn("reportTime: duration must between 0 and 60000"):this.submitCustomTime(e,t):console.warn("reportTime: second param must be number"):console.warn("reportTime: first param must be a string")},de.prototype.reportT=function(e){var t=e.name,n=e.duration,o=e.ext1,i=void 0===o?"":o,r=e.ext2,o=void 0===r?"":r,r=e.ext3,r=void 0===r?"":r,e=e.from;if("string"==typeof t&&"number"==typeof n&&"string"==typeof i&&"string"==typeof o&&"string"==typeof r){if(!(n<0||6e4<n))return this.submitCustomTime(t,n,i,o,r,void 0===e?"":e);console.warn("reportTime: duration must between 0 and 60000")}else console.warn("reportTime: params error")},de.prototype.time=function(e){"string"==typeof e?this.timeMap[e]?console.warn("Timer "+e+" already exists"):this.timeMap[e]=Date.now():console.warn("time: first param must be a string")},de.prototype.timeEnd=function(e){"string"==typeof e?this.timeMap[e]?(this.submitCustomTime(e,Date.now()-this.timeMap[e]),delete this.timeMap[e]):console.warn("Timer "+e+" does not exist"):console.warn("timeEnd: first param must be a string")},de.prototype.submitCustomTime=function(e,t,n,o,i,r){this.customTimePipeline({name:e,duration:t,ext1:n||this.config.ext1,ext2:o||this.config.ext2,ext3:i||this.config.ext3,from:r||void 0})},de.prototype.extendBean=function(e,t){this.bean[e]=t},de.prototype.sendPipeline=function(e,t){var n,r,s,a=this;return Z(l([function(e,t){if("number"!=typeof n.config.random&&(console.warn("random must in [0, 1], default is 1."),n.config.random=1),!n.isHidden||!n.isGetSample)if(n.isGetSample)n.isHidden||t(e);else{if(n.isGetSample=!0,Math.random()<n.config.random)return n.isHidden=!1,t(e);n.isHidden=!0}},(s=t,function(e,t){var n=Array.isArray(e),o=n?e:[e];r.lifeCycle.emit("beforeRequest",e);var i=r.config.beforeRequest;(o="function"==typeof i?o.map(function(t){try{var e=i({logs:t,logType:s});return(null==e?void 0:e.logType)===s&&null!=e&&e.logs?e.logs:!1!==e&&t}catch(e){return t}}).filter(function(e){return!1!==e}):o).length&&(o=function(e,t){if(!Array.isArray(e)||e.length<=1)return e;var n=[],o=[];return!(o="string"==typeof t?[t]:t)||o.length<=0||(o.forEach(function(t){e.forEach(function(e){null!=e&&e[t]&&n.push(t)})}),0<n.length&&(e=e.map(function(e){var t={};return n.forEach(function(e){t[e]=""}),E(E({},t),e)}))),e}(o,["ext1","ext2","ext3","level","trace","tag","seq"]),t(n?o:o[0]))})],e,[A(r=n=this),function(o,i){a.request(o,function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];a.failRequestCount=0,i({isErr:!1,result:t,logType:null==o?void 0:o.type,logs:null==o?void 0:o.log}),null===(e=null==o?void 0:o.success)||void 0===e||e.call.apply(e,l([o],t))},function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];10<=++a.failRequestCount&&a.destroy(),i({isErr:!0,result:t,logType:null==o?void 0:o.type,logs:null==o?void 0:o.log}),null===(e=null==o?void 0:o.fail)||void 0===e||e.call.apply(e,l([o],t))})},N(this)]))},de.prototype.send=function(e,i,r){var t=this;return Z([A(this),function(n,o){t.request(n,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];o({isErr:!1,result:e,logType:n.type,logs:n.log}),null==i||i.apply(void 0,e)},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];o({isErr:!0,result:e,logType:n.type,logs:n.log}),null==r||r.apply(void 0,e)})},N(this)])(e)},de.prototype.request=function(e,t,n){throw new Error('You need to override "request" method')},de.prototype.sendSDKError=function(e){var n=this;this.sendPipeline([function(e,t){t({url:n.config.url+"?id=1085&msg[0]="+encodeURIComponent(T(e))+"&level[0]=2&from="+n.config.id+"&count=1&version="+n.config.id+"(1.35.26)",addBean:!1,method:"get",type:S.SDK_ERROR,log:e})}],S.SDK_ERROR)(e)},de.prototype.destroy=function(e){void 0===e&&(e=!1);var t,n,o=de.instances.indexOf(this);-1!==o&&de.instances.splice(o,1);for(var i=de.installedPlugins.length-1;0<=i;i--)try{de.installedPlugins[i].unpatch(this)}catch(e){this.sendSDKError(e)}if(this.lifeCycle.emit("destroy"),this.lifeCycle.clear(),e)t=this,n=Object.getOwnPropertyDescriptors(t),Object.keys(n).forEach(function(e){n[e].writable&&(t[e]=null)}),Object.setPrototypeOf(this,null);else{for(var r=this;r.constructor!==Object&&_(r,this),r=Object.getPrototypeOf(r););0===de.instances.length&&(e=Object.getPrototypeOf(this).constructor,_(e),_(de))}},de.version="1.35.26",de.instances=[],de.logType=O,de.environment=f,de.installedPlugins=[],de),te=(fe.prototype.patch=function(e){this.canUse(e)&&this.exist(e)&&(this.instances.push(e),this.triggerInit(e),this.triggerOnNewAegis(e))},fe.prototype.unpatch=function(e){e=this.instances.indexOf(e);-1!==e&&(this.instances.splice(e,1),0===this.instances.length&&this.uninstall())},fe.prototype.countInstance=function(){return this.instances.length},fe.prototype.uninstall=function(){var e;null===(e=null===(e=this.option)||void 0===e?void 0:e.destroy)||void 0===e||e.apply(this)},fe.prototype.walk=function(n){var o=this;this.instances.forEach(function(e){var t=o.canUse(e);t&&n(e,t)})},fe.prototype.canUse=function(e){e=this.getConfig(e);return!(!e||"object"!=typeof e)||!!e},fe.prototype.getConfig=function(e){return null===(e=e.config)||void 0===e?void 0:e[this.name]},fe.prototype.exist=function(e){return-1===this.instances.indexOf(e)},fe.prototype.triggerInit=function(e){var t;this.inited||(this.inited=!0,null===(t=null===(t=this.option)||void 0===t?void 0:t.init)||void 0===t||t.call(this.option,this.getConfig(e)))},fe.prototype.triggerOnNewAegis=function(e){var t;null===(t=null===(t=this.option)||void 0===t?void 0:t.onNewAegis)||void 0===t||t.call(this.option,e,this.getConfig(e))},fe),ne=new te({name:"aid",aid:"",init:function(e){try{var t=!0!==e&&e||window.localStorage.getItem("AEGIS_ID");t||(t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}),window.localStorage.setItem("AEGIS_ID",t)),this.aid=t}catch(e){}},onNewAegis:function(e){e.bean.aid=this.aid,e.config.aid=this.aid}}),oe=function(e,t){var n,o={fetch:[],static:[]},i=new FormData;return Array.isArray(e)?e.forEach(function(e){var t=j(e);o[e.type].push(t)}):(n=j(e),o[e.type].push(n)),i.append("payload",p(E({duration:o},t))),i},ie=new te({name:"reportAssetSpeed"}),re=ie=new te({name:"reportAssetSpeed",collectCur:0,collectEntryType:"resource",ASSETS_INITIATOR_TYPE:["img","css","script","link","audio","video"],onNewAegis:function(e){var t=this;q()&&(this.collectSuccessLog(e),this.collectFailLog(e),performance.onresourcetimingbufferfull=function(){t.collectCur=0,performance.clearResourceTimings()})},publish:function(t){this.$walk(function(e){e.speedLogPipeline(t)})},publishMany:function(e,t){for(var n=t.config,o=0,i=e.length;o<i;o++){var r=e[o];-1!==this.ASSETS_INITIATOR_TYPE.indexOf(r.initiatorType)&&-1===r.name.indexOf("cdn-go.cn/aegis/aegis-sdk")&&this.publish(this.generateLog(r,n))}},collectSuccessLog:function(n){var e,t,o=this;"function"==typeof window.PerformanceObserver?(this.publishMany(performance.getEntriesByType(this.collectEntryType),n),(e=new window.PerformanceObserver(function(e){o.publishMany(e.getEntries(),n)})).observe({entryTypes:[this.collectEntryType]}),n.lifeCycle.on("destroy",function(){0===ie.countInstance()&&e.disconnect()})):(t=setInterval(function(){var e=performance.getEntriesByType(o.collectEntryType),t=e.slice(o.collectCur);o.collectCur=e.length,o.publishMany(t,n)},3e3),n.lifeCycle.on("destroy",function(){0===ie.countInstance()&&clearInterval(t)}))},collectFailLog:function(e){function t(e){var t,n;e&&(e=e.target||e.srcElement,t=(null==e?void 0:e.src)||(null==e?void 0:e.href),e=null==e?void 0:e.tagName,t&&"string"==typeof t&&("IMG"===e&&-1<window.location.href.indexOf(t)||(e="function"==typeof(null===(e=i.api)||void 0===e?void 0:e.resourceTypeHandler)?null===(n=i.api)||void 0===n?void 0:n.resourceTypeHandler(t):"",n=performance.getEntriesByType(o.collectEntryType).find(function(e){return e.name===t}),e={url:g(t),status:400,duration:Number(((null==n?void 0:n.duration)||0).toFixed(2)),method:"get",type:e||"static",isHttps:v(t),urlQuery:g(t,!0),domainLookup:0,connectTime:0},o.publish(e))))}var o=this,i=e.config;window.document.addEventListener("error",t,!0),e.lifeCycle.on("destroy",function(){0===ie.countInstance()&&window.document.removeEventListener("error",t,!0)})},generateLog:function(e,t){var n,o="function"==typeof(null===(n=t.api)||void 0===n?void 0:n.resourceTypeHandler)?null===(o=t.api)||void 0===o?void 0:o.resourceTypeHandler(e.name):"";return{url:g(e.name),method:"get",duration:Number(e.duration.toFixed(2)),status:200,type:o||"static",isHttps:v(e.name),urlQuery:g(e.name,!0),domainLookup:s(e.domainLookupEnd-e.domainLookupStart),connectTime:s(e.connectEnd-e.connectStart)}},collectNotReportedLog:function(e){var t=performance.getEntriesByType(this.collectEntryType),n=t.length;"function"!=typeof window.PerformanceObserver&&this.collectCur!==n&&(t=t.slice(this.collectCur),this.collectCur=n,this.publishMany(t,e,!0))},destroy:function(){this.option.publish=function(){}}}),se=!1,ae=[],ce=!1,ue=[],le=(new te({name:"reportApiSpeed"}),new te({name:"reportApiSpeed",override:!1,onNewAegis:function(e){this.override||(this.override=!0,this.overrideFetch(e.config),this.overrideXhr(e.config))},overrideFetch:function(l){var f=this,e={name:this.name,then:function(r,s,a,c){var e,u,t,n;l.hostUrl&&-1<a.indexOf(l.hostUrl)||(u={url:r.url,isHttps:v(r.url),method:(null==c?void 0:c.method)||"get",duration:s,type:"fetch",status:r.status||0},"fetch"!==(n="function"==typeof(null===(e=l.api)||void 0===e?void 0:e.resourceTypeHandler)?null===(t=l.api)||void 0===t?void 0:t.resourceTypeHandler(r.url):n)&&"static"!==n&&(t=r.headers?r.headers.get("content-type"):"",n=r.ok&&"string"==typeof t&&d(t)?"static":"fetch"),"fetch"===n?r.clone().text().then(function(e){var t=null===(i=l.api)||void 0===i?void 0:i.apiDetail,n=r.status<=0||400<=r.status,o=m(e,l.api,{url:a,ctx:r}),i=o.code,o=o.isErr,t=(n?"FETCH_ERROR: "+e+" \n\n":"")+"req url: "+a+" \n                                \nreq method: "+((null==c?void 0:c.method)||"get")+" \n                                \nreq param: "+(t?y(null==c?void 0:c.body):"")+" \n                                \nres duration: "+s+"ms \n                                \nres status: "+(r.status||0)+" \n                                \nres retcode: "+i+"\n                                \nres data: "+(t?e:"");u.payload=new P(r,e),u.ret=i,u.isErr=+o,f.publishNormalLog({msg:t,level:n?O.AJAX_ERROR:o?O.RET_ERROR:O.API_RESPONSE,code:i,ctx:r})}):Object.assign(u,{type:"static",urlQuery:g(r.url,!0),domainLookup:h.number,connectTime:h.number}),f.publishSpeed(u))},catch:function(e,t,n,o){if(!(l.hostUrl&&-1<n.indexOf(l.hostUrl))){var i={url:n,isHttps:v(n),method:(null==o?void 0:o.method)||"get",duration:t,type:"fetch",status:0};f.publishSpeed(i);i=null===(i=l.api)||void 0===i?void 0:i.apiDetail,o="AJAX_ERROR: "+e+"\n                          \nres status: 0\n                          \nres duration: "+t+"ms\n                          \nreq url: "+n+"\n                          \nreq method: "+((null==o?void 0:o.method)||"get")+"\n                          \nreq param: "+(i?y(null==o?void 0:o.body):"");throw f.publishNormalLog({msg:o,level:O.AJAX_ERROR,code:-400,ctx:e}),e}}};this.hackFetchOptions=e,function(t){if(ue.find(function(e){return e.name===t.name}))throw new Error("name '"+t.name+"' is already in hackFetch option list");var s;ue.push(t),!ce&&window.fetch&&(ce=!0,s=window.fetch,window.fetch=function(e,o){void 0===o&&(o={});for(var i="string"==typeof e?e:e.url,t=0;t<ue.length;t++){var n=ue[t];try{"function"==typeof n.beforeFetch&&n.beforeFetch(i,o)}catch(e){}}var r=Date.now();return s(e,o).then(function(e){for(var t=0;t<ue.length;t++){var n=ue[t];try{"function"==typeof n.then&&n.then(e,Date.now()-r,i,o)}catch(e){}}return e}).catch(function(e){for(var t=0;t<ue.length;t++){var n=ue[t];try{"function"==typeof n.catch&&n.catch(e,Date.now()-r,i,o)}catch(e){}}throw e})})}(this.hackFetchOptions)},getRequestType:function(e,t,n){var o,i="function"==typeof(null===(o=e.api)||void 0===o?void 0:o.resourceTypeHandler)?null===(i=e.api)||void 0===i?void 0:i.resourceTypeHandler(n):"";return"fetch"!==i&&"static"!==i&&(n=t.getResponseHeader("content-type"),i=400<=t.status||"string"!=typeof n||!d(n)?"fetch":"static"),i},overrideXhr:function(d){var p=this,e={name:this.name,send:function(u,l){var f=Date.now();u.addEventListener("loadend",function(){var e,t=u.aegisUrl;if(t&&!(d.hostUrl&&-1<t.indexOf(d.hostUrl))){var n=Date.now()-f,o={url:t,isHttps:v(t),status:u.status||0,method:u.aegisMethod||"get",type:"fetch",duration:n,payload:new L(u)};if("fetch"===p.getRequestType(d,u,t))try{var i=null===(e=d.api)||void 0===e?void 0:e.apiDetail,r=m(u.response,d.api,{url:t,ctx:u}),s=r.code,a=r.isErr,c="req url: "+t+" \n                                \nreq method: "+o.method+" \n                                \nreq param: "+(i?y(l):"")+" \n                                \nres duration: "+n+"ms \n                                \nres status: "+o.status+" \n                                \nres retcode: "+s+"\n                                \nres data: "+(i?y(u.response):"");o.ret=s,o.isErr=+a,p.publishNormalLog({msg:c,level:a?O.RET_ERROR:O.API_RESPONSE,code:s,ctx:u})}catch(e){o.ret="unknown"}else Object.assign(o,{type:"static",urlQuery:g(t,!0),domainLookup:h.number,connectTime:h.number});p.publishSpeed(o)}})}};this.hackXHROptions=e,D(this.hackXHROptions)},publishSpeed:function(n){var o=this;n.url=g(n.url),this.$walk(function(e){var t=o.$getConfig(e);"fetch"===n.type&&t&&"function"==typeof t.urlHandler?e.speedLogPipeline(E(E({},n),{url:encodeURIComponent(t.urlHandler(n.url,n.payload))})):e.speedLogPipeline(n)})},publishNormalLog:function(t){this.$walk(function(e){e.normalLogPipeline(t)})},destroy:function(){var t,e;this.option.publishSpeed=function(){},this.option.publishNormalLog=function(){},this.option.hackXHROptions&&M(this.option.hackXHROptions),this.option.hackFetchOptions&&(t=this.option.hackFetchOptions,-1!==(e=ue.findIndex(function(e){return e.name===t.name}))&&ue.splice(e,1))}}));function fe(e){this.aegisPlugin=!0,this.name="",this.instances=[],this.inited=!1,e.$walk=this.walk.bind(this),e.$getConfig=this.getConfig.bind(this),this.option=e,this.name=e.name}function de(e){var n,t,i=this;this.isGetSample=!1,this.isHidden=!1,this.config={version:0,delay:1e3,onError:!0,repeat:5,random:1,aid:!0,device:!0,pagePerformance:!0,webVitals:!0,speedSample:!0,onClose:!0,hostUrl:"https://aegis.qq.com",websocketHack:!1,env:"production",url:"",offlineUrl:"",whiteListUrl:"",pvUrl:"",speedUrl:"",customTimeUrl:"",performanceUrl:"",webVitalsUrl:"",eventUrl:"",setDataReportUrl:""},this.isWhiteList=!1,this.lifeCycle=new r,this.bean={},this.normalLogPipeline=Z([V(this,5),X,function(e,t){var o=n.config;t(e=e.map(function(e){var t,n=o.maxLength||204800;try{if(!e.msg||e.msg.length<=n)return e;e.msg=null===(t=e.msg)||void 0===t?void 0:t.substring(0,n)}catch(t){e.msg=T(e.msg).substring(0,o.maxLength)}return e}))},Q((n=this).config),W(this.lifeCycle.emit,this.config),J(this),G(this),function(e,t){try{var n=JSON.parse(JSON.stringify(e));i.lifeCycle.emit("beforeReport",n);var o=i.config.beforeReport;(e="function"==typeof o?e.filter(function(e){return!1!==o(e)}):e).length&&t(e)}catch(e){}},K(this)]),this.eventPipeline=Z([V(this,5),Y(this)]),this.timeMap={},this.failRequestCount=0,this.customTimePipeline=Z([V(this,5),z(this)]),this.config=(t=this.config,void 0===(e=e.hostUrl)&&(e="https://aegis.qq.com"),t.url=t.url||e+"/collect",t.offlineUrl=t.offlineUrl||e+"/offline",t.whiteListUrl=t.whiteListUrl||e+"/collect/whitelist",t.pvUrl=t.pvUrl||e+"/collect/pv",t.eventUrl=t.eventUrl||e+"/collect/events",t.speedUrl=t.speedUrl||e+"/speed",t.customTimeUrl=t.customTimeUrl||e+"/speed/custom",t.performanceUrl=t.performanceUrl||e+"/speed/performance",t.webVitalsUrl=t.webVitalsUrl||e+"/speed/webvitals",t.setDataReportUrl=t.SetDataReportUrl||e+"/speed/miniProgramData",t),de.instances.push(this)}(st=H=H||{})[st.unknown=100]="unknown",st[st.wifi=1]="wifi",st[st.net2g=2]="net2g",st[st.net3g=3]="net3g",st[st.net4g=4]="net4g",st[st.net5g=5]="net5g",st[st.net6g=6]="net6g",(et=B=B||{})[et.android=1]="android",et[et.ios=2]="ios",et[et.windows=3]="windows",et[et.macos=4]="macos",et[et.linux=5]="linux",et[et.other=100]="other";var pe,he,ge,ve,me,ye,we,be,Ee,Re,Oe=new te({name:"device",onNewAegis:function(e){e.extendBean("platform",this.getPlatform()),e.extendBean("netType",H.unknown),this.getDpi(e),this.refreshNetworkTypeToBean(e)},getDpi:function(e){e.extendBean("vp",Math.round(window.innerWidth)+" * "+Math.round(window.innerHeight)),window.screen&&e.extendBean("sr",Math.round(window.screen.width)+" * "+Math.round(window.screen.height))},getPlatform:function(){var t={android:/\bAndroid\s*([^;]+)/,ios:/\b(iPad|iPhone|iPod)\b.*? OS ([\d_]+)/,windows:/\b(Windows NT)/,macos:/\b(Mac OS)/,linux:/\b(Linux)/i},e=Object.keys(t).find(function(e){return t[e].test(navigator.userAgent)});return e?B[e]:B.other},refreshNetworkTypeToBean:function(t){var n=this,e=t.config;e&&("function"==typeof e.getNetworkType?e.getNetworkType:Se)(function(e){H[e]||(e=H.unknown),t.extendBean("netType",e),n.NetworkRefreshTimer=setTimeout(function(){n.refreshNetworkTypeToBean(t),clearTimeout(n.NetworkRefreshTimer)},1e4)})}}),Se=function(e){var t="",n=navigator.userAgent.match(/NetType\/(\w+)/);n?t=n[1]:navigator.connection&&(t=navigator.connection.effectiveType||navigator.connection.type),e((t=t=t||"unknown",0<=(t=String(t).toLowerCase()).indexOf("4g")?H.net4g:0<=t.indexOf("wifi")?H.wifi:0<=t.indexOf("5g")?H.net5g:0<=t.indexOf("6g")?H.net6g:0<=t.indexOf("3g")?H.net3g:0<=t.indexOf("2g")?H.net2g:H.unknown))},Te=window.WebSocket,Le=[],Pe={construct:function(e,t){var s=new e(t[0],t[1]);return s.originSend=s.send,s.addEventListener("error",function(e){var e=(null==e?void 0:e.currentTarget)||{},t=e.url,n=e.readyState;null==Le||Le.forEach(function(e){e=e.onErr;null==e||e({msg:"无法获知具体错误信息，需在浏览器控制台查看！",readyState:n,connectUrl:t})})}),Object.defineProperty(s,"send",{get:function(){return function(e){null===(i=s.originSend)||void 0===i||i.call(s,e);var t=s.readyState,n=WebSocket.OPEN,o=WebSocket.CLOSED,i=WebSocket.CONNECTING,e=WebSocket.CLOSING;if(t!==n){var r={readyState:t,connectUrl:s.url};switch(t){case o:Le.forEach(function(e){e=e.sendErr;null==e||e(E({msg:"消息发送失败，连接已关闭！"},r))});break;case i:Le.forEach(function(e){(0,e.sendErr)(E({msg:"消息发送失败，正在连接中！"},r))});break;case e:Le.forEach(function(e){(0,e.sendErr)(E({msg:"消息发送失败，连接正在关闭！"},r))})}}}}}),s}},xe=new te({name:"onError"}),Ce=xe=new te({name:"onError",onNewAegis:function(e){this.startListen(e)},startListen:function(r){var o=this,n=window.onerror;window.onerror=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];o.publishErrorLog({msg:(T(e[0])||"")+" @ ("+(T(e[1])||"")+":"+(e[2]||0)+":"+(e[3]||0)+")\n          \n"+T(e[4]||""),level:O.ERROR}),null==n||n.call.apply(n,l([window],e))};function e(e){e=e&&T(e.reason),o.publishErrorLog({msg:"PROMISE_ERROR: "+e,level:O.PROMISE_ERROR})}window.addEventListener("unhandledrejection",e);function t(e){var t=(null==e?void 0:e.target)||(null==e?void 0:e.srcElement);if(t){e=t.src||t.href,t=t.tagName;if("string"==typeof e&&t&&!(-1<window.location.href.indexOf(e))){var n={msg:t+" load fail: "+e,level:O.INFO};if(/\.js$/.test(e))n.level=O.SCRIPT_ERROR;else if(/\.css$/.test(e))n.level=O.CSS_ERROR;else switch(t.toLowerCase()){case"script":n.level=O.SCRIPT_ERROR;break;case"link":n.level=O.CSS_ERROR;break;case"img":n.level=O.IMAGE_ERROR;break;case"audio":case"video":n.level=O.MEDIA_ERROR;break;default:return}o.publishErrorLog(n)}}}window.document.addEventListener("error",t,!0),r.lifeCycle.on("destroy",function(){0===xe.countInstance()&&(window.document.removeEventListener("unhandledrejection",e),window.document.removeEventListener("error",t,!0))});var i,s,a,c=this,u={name:this.name,send:function(o,i){o.addEventListener("loadend",function(){var e,t,n="";this.failType?n=this.failType:this.status?400<=this.status&&(n="error"):n="failed",r.config.hostUrl&&this.aegisUrl&&-1<this.aegisUrl.indexOf(r.config.hostUrl)||(t=null===(e=r.config.api)||void 0===e?void 0:e.apiDetail,n&&(e=o.aegisUrl,e=m(o.response,r.config.api,{url:e,ctx:o}).code,c.publishErrorLog({msg:"AJAX_ERROR: request "+n+"\n                      \nreq url: "+this.aegisUrl+"\n                      \nres status: "+(this.status||0)+"\n                      \nres retcode: "+e+"\n                      \nres duration: "+(Date.now()-o.aegisXhrStartTime)+"ms\n                      \nreq method: "+this.aegisMethod+"\n                      \nreq param: "+(t?y(i):"")+"\n                      \nres data: "+(t?null===(t=(t=o).responseType&&"text"!==t.responseType?"":t.responseText)||void 0===t?void 0:t.slice(0,1e3):""),level:O.AJAX_ERROR,ctx:o})))}),o.addEventListener("timeout",function(){o.failType="timeout"}),o.addEventListener("error",function(){o.failType="error"}),o.addEventListener("abort",function(){o.failType="abort"})}};this.hackXHROptions=u,D(this.hackXHROptions),r.config.websocketHack&&(s={key:r.config.id+"-"+this.name,onErr:function(e){var t;null===(t=o.publishWsErrorLog)||void 0===t||t.call(o,e)},sendErr:function(e){var t;null===(t=o.publishWsErrorLog)||void 0===t||t.call(o,e)}},this.hackWebsocketConfig=s,i=this.hackWebsocketConfig,window.Proxy&&window.WebSocket&&(u=window.WebSocket,window&&!u.isHack&&(s=new Proxy(WebSocket,Pe),u.isHack=!0,window.WebSocket=s),a=i,Le.find(function(e){return e.key===a.key})||a&&Le.push(a)))},publishErrorLog:function(t){this.$walk(function(e){e.normalLogPipeline(t)})},publishWsErrorLog:function(e){var t=e.connectUrl,n=e.msg,e=e.readyState;this.publishErrorLog({msg:"WEBSOCKET_ERROR: \n              connect: "+t+"\n              readyState: "+e+"\n              msg: "+n,level:O.WEBSOCKET_ERROR})},destroy:function(){this.option.publishErrorLog=function(){},this.option.hackXHROptions&&M(this.option.hackXHROptions),this.option.hackWebsocketConfig&&function(t){window.WebSocket=Te;var e=Le.findIndex(function(e){return e.key===t.key});-1!==e&&Le.splice(e,1)}(this.option.hackWebsocketConfig)}}),Ie=(new te({name:"pagePerformance"}),function(e,t,n,o){return void 0===n&&(n=15e3),void 0===o&&(o=0),(t=void 0===t?0:t)<=e&&e<=n?e:o}),ke=1,Ae=new te({name:"pagePerformance",onNewAegis:function(n){var o=this;if(q())if(pe)this.publish(pe,n);else try{this.getFirstScreenTiming(n,function(e){var t=performance.timing;t&&(pe={dnsLookup:Ie(t.domainLookupEnd-t.domainLookupStart),tcp:Ie(t.connectEnd-t.connectStart),ssl:Ie(0===t.secureConnectionStart?0:t.requestStart-t.secureConnectionStart),ttfb:Ie(t.responseStart-t.requestStart),contentDownload:Ie(t.responseEnd-t.responseStart),domParse:Ie(t.domInteractive-t.domLoading),resourceDownload:Ie(t.loadEventStart-t.domInteractive,0,15e3,1070),firstScreenTiming:Ie(Math.floor(e),0,6e4)},o.publish(pe,n))})}catch(n){}},publish:function(e,s){var a=this;s.sendPipeline([function(e,t){var n,o=[];for(n in e)o.push(n+"="+e[n]);var i=a.$getConfig(s);if(i){var r=-1===s.config.performanceUrl.indexOf("?")?"?":"&";return"function"==typeof i.urlHandler?t({url:s.config.performanceUrl+r+o.join("&")+"&from="+(encodeURIComponent(i.urlHandler())||window.location.href),beanFilter:["from"],type:S.PERFORMANCE,log:e}):t({url:s.config.performanceUrl+r+o.join("&"),type:S.PERFORMANCE,log:e})}}],S.PERFORMANCE)(e)},getFirstScreenTiming:function(r,n){r.lifeCycle.on("destroy",function(){f&&clearTimeout(f)});var o=["script","style","link","br"],s=[],a=this,c={},u=new MutationObserver(function(e){var t={roots:[],rootsDomNum:[],time:performance.now()};e.forEach(function(e){e&&e.addedNodes&&e.addedNodes.forEach&&e.addedNodes.forEach(function(e){1===e.nodeType&&(e.hasAttribute("AEGIS-FIRST-SCREEN-TIMING")||e.querySelector("[AEGIS-FIRST-SCREEN-TIMING]"))?(Object.prototype.hasOwnProperty.apply(c,[t.time])||(c[t.time]=[]),c[t.time].push(e)):1!==e.nodeType||-1!==o.indexOf(e.nodeName.toLocaleLowerCase())||a.isEleInArray(e,t.roots)||e.hasAttribute("AEGIS-IGNORE-FIRST-SCREEN-TIMING")||(t.roots.push(e),t.rootsDomNum.push(a.walkAndCount(e)||0))})}),t.roots.length&&s.push(t)});u.observe(document,{childList:!0,subtree:!0});var l=function(){var e,o=0,i=0,t=Object.keys(c).filter(function(e){return c[+e].find(function(e){return a.isInFirstScreen(e)})});t.length?(i=Math.max.apply(null,t),("object"!=typeof(null===(t=r.config)||void 0===t?void 0:t.pagePerformance)||null!==(e=r.config.pagePerformance)&&void 0!==e&&e.firstScreenInfo)&&(r.firstScreenInfo={element:null===(e=c[i])||void 0===e?void 0:e[0],timing:i,markDoms:c})):s.forEach(function(e){for(var t,n=0;n<e.roots.length;n++)e.rootsDomNum[n]>o&&a.isInFirstScreen(e.roots[n])&&(o=e.rootsDomNum[n],i=e.time,("object"!=typeof(null===(t=r.config)||void 0===t?void 0:t.pagePerformance)||null!==(t=r.config.pagePerformance)&&void 0!==t&&t.firstScreenInfo)&&(r.firstScreenInfo={element:e.roots[n],timing:i}))}),!i&&ke?f=setTimeout(function(){return l()},3e3):(u.disconnect(),null==n||n(i)),--ke},f=setTimeout(function(){return l()},3e3)},isEleInArray:function(e,t){return!(!e||e===document.documentElement)&&(-1!==t.indexOf(e)||this.isEleInArray(e.parentElement,t))},isInFirstScreen:function(e){if(!e||"function"!=typeof e.getBoundingClientRect)return!1;var t=e.getBoundingClientRect(),n=window.innerHeight,e=window.innerWidth;return 0<=t.left&&t.left<e&&0<=t.top&&t.top<n&&0<t.width&&0<t.height},walkAndCount:function(e){var t=0;if(e&&1===e.nodeType){t+=1;var n=e.children;if(null!=n&&n.length)for(var o=0;o<n.length;o++)t+=this.walkAndCount(n[o])}return t}});function Ne(){me=[],ge=-1,he=null,Ee(addEventListener)}function Ue(e,t){he||(he=t,ge=e,ve=new Date,Ee(removeEventListener),be())}function _e(e){var t,n,o,i;function r(){Ue(n,o),i()}function s(){i()}e.cancelable&&(t=(1e12<e.timeStamp?new Date:performance.now())-e.timeStamp,"pointerdown"==e.type?(n=t,o=e,i=function(){removeEventListener("pointerup",r,ye),removeEventListener("pointercancel",s,ye)},addEventListener("pointerup",r,ye),addEventListener("pointercancel",s,ye)):Ue(t,e))}ye={passive:!0,capture:!0},we=new Date,be=function(){var t;0<=ge&&ge<ve-we&&(t={entryType:"first-input",name:he.type,target:he.target,cancelable:he.cancelable,startTime:he.timeStamp,processingStart:he.timeStamp+ge},me.forEach(function(e){e(t)}),me=[])},Ee=function(t){["mousedown","keydown","touchstart","pointerdown"].forEach(function(e){return t(e,_e,ye)})},Re="hidden"===document.visibilityState?0:1/0,addEventListener("visibilitychange",function e(t){"hidden"===document.visibilityState&&(Re=t.timeStamp,removeEventListener("visibilitychange",e,!0))},!0),Ne(),self.webVitals={firstInputPolyfill:function(e){me.push(e),be()},resetFirstInputPolyfill:Ne,get firstHiddenTime(){return Re}};function je(e,t){return{name:e,value:void 0===t?-1:t,delta:0,entries:[],id:"v1-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12)}}function qe(e,t){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){if("first-input"===e&&!("PerformanceEventTiming"in self))return;var n=new PerformanceObserver(function(e){return e.getEntries().map(t)});return n.observe({type:e,buffered:!0}),n}}catch(e){}}function Fe(t,n){function o(e){"pagehide"!==e.type&&"hidden"!==document.visibilityState||(t(e),n&&(removeEventListener("visibilitychange",o,!0),removeEventListener("pagehide",o,!0)))}addEventListener("visibilitychange",o,!0),addEventListener("pagehide",o,!0)}function De(t){addEventListener("pageshow",function(e){e.persisted&&t(e)},!0)}function Me(e,t,n){var o;return function(){0<=t.value&&(n||Je.has(t)||"hidden"===document.visibilityState)&&(t.delta=t.value-(o||0),!t.delta&&void 0!==o||(o=t.value,e(t)))}}function He(){Fe(function(e){e=e.timeStamp;$e=e},!0)}function Be(){return $e<0&&(($e=self.webVitals.firstHiddenTime)===1/0&&He(),De(function(){setTimeout(function(){$e="hidden"===document.visibilityState?0:1/0,He()},0)})),{get timeStamp(){return $e}}}function We(e){var t=e.name,e=e.value;Qe[t]=e}function Ve(e,h){function g(e){b=e}function v(e){y=y.concat(e)}function m(e,t){w={conds:e=void 0===e?{}:e,params:t=void 0===t?{}:t}}var y=[],w=null,b=null;ze.useAsyncPlugin(e,{exportsConstructor:"Flog",onAegisInit:function(e){e.lifeCycle.on("beforeWrite",v),e.lifeCycle.on("uploadLogs",m),e.lifeCycle.on("onConfigChange",g)},onAegisInitAndPluginLoaded:function(o,e){var t,n,i,r,s,a=h.dbConfig,c=void 0===a?{}:a,u=h.url,l=void 0===u?ze.urls.aegisCollect:u,f=h.offlineLogExp,d=void 0===f?3:f,a=h.id,u=h.uin;null===(f=o.lifeCycle)||void 0===f||f.remove("beforeWrite",v),null===(f=o.lifeCycle)||void 0===f||f.remove("uploadLogs",m),null===(f=o.lifeCycle)||void 0===f||f.remove("onConfigChange",g);c=Object.assign({lookupUrl:l+"/offlineAuto?id="+a,preservedDay:d,id:a,uin:u,aid:(null===(u=o.bean)||void 0===u?void 0:u.aid)||"",beforeRequest:o.config.beforeRequest,afterRequest:o.config.afterRequest},c,{sessionId:ze.sessionID});try{var p=new e(c);y.forEach(function(e){p.add(E(E({},e),{level:e.level===O.INFO_ALL?O.INFO:e.level}))}),null===(t=o.lifeCycle)||void 0===t||t.on("beforeWrite",function(e){(e=void 0===e?[]:e).forEach(function(e){p.add(E(E({},e),{level:e.level===O.INFO_ALL?O.INFO:e.level}))})}),null===(n=o.lifeCycle)||void 0===n||n.on("uploadLogs",function(e,t){var n;void 0===e&&(e={}),void 0===t&&(t={}),p.uploadLogs(Object.assign({id:h.id,uin:h.uin,aid:null===(n=o.bean)||void 0===n?void 0:n.aid},e),t)}),null===(i=o.lifeCycle)||void 0===i||i.on("onConfigChange",function(e){p.setConfig(e)}),null===(r=o.lifeCycle)||void 0===r||r.on("destroy",function(){0===Ze.countInstance()&&(y.length=0,"function"==typeof((w=null)==p?void 0:p.destroy)&&p.destroy())}),p.on("PERREVENT",function(e){o.sendPipeline([function(e,t){var n=(n={msg:T(e),level:O.INFO},(n=Array.isArray(n)?n:[n]).map(function(t,n){return Object.getOwnPropertyNames(t).map(function(e){return R(e)+"["+n+"]="+(void 0===t[e]?"":R(t[e]))}).join("&")}).join("&")+(n.length?"&count="+n.length:""));t({type:S.OFFLINE,data:n,contentType:"application/x-www-form-urlencoded",method:"post",addBean:!1,url:h.url+"?id=893&sessionId="+ze.sessionID+"&uin="+h.uin+"&from="+h.id+"&count=1&version=1.35.26",log:e})}],S.OFFLINE)(e)}),b&&(p.setConfig(b),b=null),w&&(null===(s=o.lifeCycle)||void 0===s||s.emit("uploadLogs",w.conds,w.params),w=null),o.flog=p}catch(o){console.log(o)}}})}var Xe,Ge,Je=new("function"==typeof WeakSet?WeakSet:Set),$e=-1,Qe=(new te({name:"webVitals"}),{FCP:-1,LCP:-1,FID:-1,CLS:-1}),Ke=new te({name:"webVitals",onNewAegis:function(e){if(q()&&"function"==typeof window.PerformanceObserver)try{m=We,w=Be(),b=je("FCP"),E=performance.getEntriesByName("first-contentful-paint")[0],R=E?null:qe("paint",T),(E||R)&&(y=Me(m,b,void 0),E&&T(E),De(function(e){b=je("FCP"),y=Me(m,b,void 0),requestAnimationFrame(function(){requestAnimationFrame(function(){b.value=performance.now()-e.timeStamp,Je.add(b),y()})})})),f=We,h=Be(),g=je("LCP"),(v=qe("largest-contentful-paint",S))&&(d=Me(f,g,void 0),p=function(){Je.has(g)||(v.takeRecords().map(S),v.disconnect(),Je.add(g),d())},["keydown","click"].forEach(function(e){addEventListener(e,p,{once:!0,capture:!0})}),Fe(p,!0),De(function(e){g=je("LCP"),d=Me(f,g,void 0),requestAnimationFrame(function(){requestAnimationFrame(function(){g.value=performance.now()-e.timeStamp,Je.add(g),d()})})})),s=We,a=Be(),c=je("FID"),u=qe("first-input",O),l=Me(s,c,void 0),u&&Fe(function(){u.takeRecords().map(O),u.disconnect()},!0),u||window.webVitals.firstInputPolyfill(O),De(function(){c=je("FID"),l=Me(s,c,void 0),window.webVitals.resetFirstInputPolyfill(),window.webVitals.firstInputPolyfill(O)}),n=We,i=je("CLS",0),(r=qe("layout-shift",t))&&(o=Me(n,i,void 0),Fe(function(){r.takeRecords().map(t),o()}),De(function(){i=je("CLS",0),o=Me(n,i,void 0)})),F(this.publish.bind(this,e),!0)}catch(e){}function t(e){e.hadRecentInput||(i.value+=e.value,i.entries.push(e),o())}var n,o,i,r,s,a,c,u,l,f,d,p,h,g,v,m,y,w,b,E,R;function O(e){e.startTime<a.timeStamp&&(c.value=e.processingStart-e.startTime,c.entries.push(e),Je.add(c),l())}function S(e){var t=e.startTime;t<h.timeStamp&&(g.value=t,g.entries.push(e)),d()}function T(e){"first-contentful-paint"===e.name&&(R&&R.disconnect(),e.startTime<w.timeStamp&&(b.value=e.startTime,b.entries.push(e),Je.add(b),y()))}},publish:function(r){r.sendPipeline([function(e,t){var n,o=[];for(n in e)o.push(n+"="+e[n]);var i=-1===r.config.performanceUrl.indexOf("?")?"?":"&";t({url:r.config.webVitalsUrl+i+o.join("&"),type:S.VITALS,log:e,sendBeacon:!0})}],S.VITALS)(Qe)},destroy:function(){this.option.publish=function(){}}}),Ye=0,ze=(o(Ge=tt,st=Xe=ee),Ge.prototype=null===st?Object.create(st):(nt.prototype=st.prototype,new nt),tt.prototype.getBean=function(t){var n=this;return void 0===t&&(t=[]),""+Object.getOwnPropertyNames(this.bean).filter(function(e){return-1===t.indexOf(e)}).map(function(e){return e+"="+n.bean[e]}).join("&")},tt.prototype.resetRequesting=function(){var e;this.sendNow||(this.requesting=!1,(e=this.requestQueue.shift())&&this.request(e.options,e.success,e.fail))},tt.prototype.request=function(e,t,n){var o=this;if(e&&"string"==typeof e.url&&""!==e.url&&this.bean.id)if(this.sendNow||!this.requesting){this.requesting=!0;var i=e.url;!1!==e.addBean&&(i=i+(-1===i.indexOf("?")?"?":"&")+this.getBean(e.beanFilter)),e.url=i;var r=e.method||"get",i=this.config.onBeforeRequest;if(!(e=i?i(e,this):e))return this.resetRequesting(),console.warn("Sending request blocked");if(!e.url)return this.resetRequesting(),console.warn("Please handle the parameters reasonably, options.url is necessary");if((e.sendBeacon||this.sendNow)&&"function"==typeof navigator.sendBeacon)return this.resetRequesting(),void navigator.sendBeacon(e.url,e.data);var s=new XMLHttpRequest;s.sendByAegis=!0,s.addEventListener("readystatechange",function(){4===s.readyState&&(o.resetRequesting(),400<=s.status||0===s.status?null==n||n(s.response):null==t||t(s.response))}),"get"===r.toLocaleLowerCase()?(s.open("get",function(e,n){if("string"!=typeof e)return"";if("object"==typeof n&&n){var t=Object.getOwnPropertyNames(n).map(function(e){var t=n[e];return e+"="+("string"==typeof t?encodeURIComponent(t):encodeURIComponent(JSON.stringify(t)))}).join("&").replace(/eval/gi,"evaI");return e+(-1===e.indexOf("?")?"?":"&")+t}return e}(e.url,e.data)),s.send()):(s.open("post",e.url),e.contentType&&s.setRequestHeader("Content-Type",e.contentType),"string"==typeof e.data&&(e.data=e.data.replace(/eval/gi,"evaI")),s.send(e.data))}else this.requestQueue.push({options:e,success:t,fail:n})},tt.useAsyncPlugin=function(s,e){var t=(e=void 0===e?{}:e).exportsConstructor,a=void 0===t?"aegis-plugin-"+Ye:t,t=e.onAegisInit,c=void 0===t?function(){}:t,e=e.onAegisInitAndPluginLoaded,u=void 0===e?function(){}:e;if(Ye+=1,"string"!=typeof s)throw new TypeError("useAsyncPlugin first param must be string");if("function"!=typeof c||"function"!=typeof u)throw new TypeError("onAegisInit and onAegisInitAndPluginLoaded must be function");this.use(new te({name:"asyncPlugin",onNewAegis:function(t){try{c(t),tt.asyncPlugin[s]?u(t,window[tt.asyncPlugin[s]]):(e=s,n=a,o=function(e){e||(tt.asyncPlugin[s]=a,e=window[a],u(t,e))},i=document.createElement("script"),r=document.head,"function"==typeof n&&(o=n,n=""),i.src=e,i.setAttribute("name",n),i.name=n,i.setAttribute("crossorigin","anonymous"),i.crossorigin="anonymous",i.defer=!0,i.hasLoaded=!1,i.onreadystatechange=function(){i.hasLoaded||i.readyState&&"loaded"!==i.readyState&&"complete"!==i.readyState||(i.hasLoaded=!0,"function"==typeof o&&o(!1),setTimeout(function(){r.contains(i)&&r.removeChild(i)}))},i.onload=i.onreadystatechange,i.onerror=function(){"function"==typeof o&&o(!0),setTimeout(function(){r.contains(i)&&r.removeChild(i)})},"complete"===document.readyState?r.appendChild(i):window.addEventListener("load",function(){r.appendChild(i)}))}catch(e){console.log("error on below is caused by "+s+" "),console.error(e)}var e,n,o,i,r}}))},tt.prototype.publishPluginsLogs=function(){var e=tt.installedPlugins.find(function(e){return"reportAssetSpeed"===e.name});null==e||e.option.collectNotReportedLog(this)},tt.prototype.publishLogsQueue=function(){var t=this;this.sendNow=!0,this.requestQueue.forEach(function(e){e.option&&(e.option=E(E({},e.option),{sendBeacon:!0})),t.request(e)}),this.requestQueue=[]},tt.prototype.uploadLogs=function(e,t){this.lifeCycle.emit("uploadLogs",e=void 0===e?{}:e,t=void 0===t?{}:t)},tt.sessionID="session-"+Date.now(),tt.asyncPlugin={},tt.urls={aegisCollect:"https://aegis.qq.com/collect",flog:"https://cdn-go.cn/vasdev/web_webpersistance_v2/v1.8.2/flog.core.min.js",shadowLog:""},tt),Ze=new te({name:"offlineLog"}),et=Ze=new te({name:"offlineLog",onNewAegis:function(e){Ve(ze.urls.flog,e.config)}}),ee=(new te({name:"spa"}),new te({name:"spa",init:function(){history.pushState=this.wr("pushState")||history.pushState,history.replaceState=this.wr("replaceState")||history.replaceState;var e=(null===(e=location.href)||void 0===e?void 0:e.split("?"))[0];this.$fireUrl=e,this.sendPv=this.sendPv.bind(this),this.onPageChange()},onPageChange:function(){window.addEventListener("replaceState",this.sendPv),window.addEventListener("pushState",this.sendPv),window.addEventListener("popstate",this.sendPv)},wr:function(n){var o=history[n],e="__"+n+"__hasWrittenByTamSpa";return"function"==typeof o&&!history[e]&&(Object.defineProperty(history,e,{value:!0,enumerable:!1}),function(){var e=o.apply(this,arguments),t=null;return"function"==typeof Event?t=new Event(n):(t=document.createEvent("HTMLEvents")).initEvent(n,!1,!0),window.dispatchEvent(t),e})},sendPv:function(){var t=this;setTimeout(function(){var o=location.href,e=(null===(e=location.href)||void 0===e?void 0:e.split("?"))[0];e&&e!==t.$fireUrl&&(t.$walk(function(n){n.sendPipeline([function(e,t){t({url:n.config.pvUrl+"?from="+encodeURIComponent(o),beanFilter:["from"],type:S.PV})}],S.PV)(null)}),t.$fireUrl=e)},0)},destroy:function(){window.removeEventListener("replaceState",this.option.sendPv),window.removeEventListener("pushState",this.option.sendPv),window.removeEventListener("popstate",this.option.sendPv)}}));function tt(e){var t,n,o,r=Xe.call(this,e)||this;r.sendNow=!1,r.requestQueue=[],r.requesting=!1,r.speedLogPipeline=Z([V(r),$(r.config),(o=r,function(t,n){Se(function(e){o.extendBean("netType",e),n(t)})}),function(e,t){r.lifeCycle.emit("beforeReportSpeed",e);var i=r.config.beforeReportSpeed;if((e="function"==typeof i?e.filter(function(e){var t,n,o=!1!==i(e);return"fetch"===e.type&&void 0===e.ret&&e.payload&&(t=(n=m(e.payload.data.response,r.config.api,{url:e.payload.data.url,ctx:e.payload.data})||{}).code,n=n.isErr,e.ret=t,e.isErr=+n),o}):e).length)return t(e)},function(e){return r.sendPipeline([function(e,t){t({type:S.SPEED,url:""+r.config.speedUrl,method:"post",data:oe(e,r.bean),log:e})}],S.SPEED)(e)}]),e.asyncPlugin=!0;try{"undefined"!=typeof document&&(e.uin=e.uin||(null!==(t=document.cookie.match(/\buin=\D+(\d*)/))&&void 0!==t?t:[])[1]||(null!==(n=document.cookie.match(/\bilive_uin=\D*(\d+)/))&&void 0!==n?n:[])[1]||""),r.init(e),r.extendBean("sessionId",tt.sessionID),r.extendBean("from",encodeURIComponent(e.pageUrl||location.href)),"undefined"!=typeof document&&r.extendBean("referer",encodeURIComponent(document.referrer||"")),e.ext1&&r.extendBean("ext1",encodeURIComponent(e.ext1)),e.ext2&&r.extendBean("ext2",encodeURIComponent(e.ext2)),e.ext3&&r.extendBean("ext3",encodeURIComponent(e.ext3))}catch(e){console.warn(e),console.log("%cThe above error occurred in the process of initializing Aegis, which will affect your normal use of Aegis.\nIt is recommended that you contact us for feedback and thank you for your support.","color: red"),r.sendSDKError(e)}return r}function nt(){this.constructor=Ge}new te({name:"ie"});function ot(e){return-1!==it.indexOf(e)}var it=window.navigator.userAgent.toLowerCase(),rt={};rt.macos=function(){return ot("mac")},rt.ios=function(){return rt.iphone()||rt.ipod()||rt.ipad()},rt.iphone=function(){return!rt.windows()&&ot("iphone")},rt.ipod=function(){return ot("ipod")},rt.ipad=function(){var e="MacIntel"===navigator.platform&&1<navigator.maxTouchPoints;return ot("ipad")||e},rt.android=function(){return!rt.windows()&&ot("android")},rt.androidPhone=function(){return rt.android()&&ot("mobile")},rt.androidTablet=function(){return rt.android()&&!ot("mobile")},rt.blackberry=function(){return ot("blackberry")||ot("bb10")},rt.blackberryPhone=function(){return rt.blackberry()&&!ot("tablet")},rt.blackberryTablet=function(){return rt.blackberry()&&ot("tablet")},rt.windows=function(){return ot("windows")},rt.windowsPhone=function(){return rt.windows()&&ot("phone")},rt.windowsTablet=function(){return rt.windows()&&ot("touch")&&!rt.windowsPhone()},rt.fxos=function(){return(ot("(mobile")||ot("(tablet"))&&ot(" rv:")},rt.fxosPhone=function(){return rt.fxos()&&ot("mobile")},rt.fxosTablet=function(){return rt.fxos()&&ot("tablet")},rt.meego=function(){return ot("meego")},rt.cordova=function(){return window.cordova&&"file:"===location.protocol},rt.nodeWebkit=function(){return"object"==typeof window.process},rt.mobile=function(){return rt.androidPhone()||rt.iphone()||rt.ipod()||rt.windowsPhone()||rt.blackberryPhone()||rt.fxosPhone()||rt.meego()},rt.tablet=function(){return rt.ipad()||rt.androidTablet()||rt.blackberryTablet()||rt.windowsTablet()||rt.fxosTablet()},rt.desktop=function(){return!rt.tablet()&&!rt.mobile()},new te({name:"onClose"});var st=new te({name:"onClose",onNewAegis:function(){var n,o=this;rt.desktop()?(n=window.onunload,window.onunload=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];o.publishNotReportedLog(),null==n||n.call.apply(n,l([window],e))}):F(this.publishNotReportedLog.bind(this),!0)},publishNotReportedLog:function(){var t=this;this.$walk(function(e){e.sendNow=!0,e.publishPluginsLogs(),e.publishLogsQueue(),t.publishThrottlePipeLogs(e)})},publishThrottlePipeLogs:function(e){null==e||e.speedLogPipeline([]),null==e||e.eventPipeline([]),null==e||e.customTimePipeline([]),null==e||e.normalLogPipeline([])}});return ze.use(Ce),ze.use(le),ze.use(re),ze.use(Ae),ze.use(Ke),ze.use(ne),ze.use(Oe),ze.use(et),ze.use(ee),ze.use(st),ze}();
